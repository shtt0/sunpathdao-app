#委託ユーザ向けの機能

##ログイン、マイページ

- ログイン画面.phantom walletを使ったwallet connectによる認証.
- ログイン済の状態の場合,委託者用マイページに遷移する.
- マイページでは,自身にかかわる案件のテーブルが表示されるテーブルの上には、新規案件の登録用ボタンがある.テーブル内には自身が登録した案件情報のステータスが表示される.
- 新規案件の登録用ボタンを押すと,フォーム入力するためのページに遷移する.

#ユーザ向けの委託案件内容のフォーム登録ページ

・以下の項目を入力する.

- 案件タイトル（テキスト）※自由入力
- 案件概要（テキスト）※自由入力
- 国名（Country）※プルダウン選択式
- 都市名（City）　※自由入力
- 出発地（テキスト）※自由入力
- 到着地（テキスト）※自由入力

・ユーザに走って欲しいルートの登録.google map API を使って,google mapをdapps上に表示し,入力窓に出発地と到着地を入力.候補ルートが表示されるので,問題なければ選択.(これはgoogle mapの機能をそのまま使いたいが,可能か？)

・#報酬数.この案件を達成したユーザに対して,支払う報酬額の登録.単位はSOL.

・案件の有効日時(何時まで登録※その1秒前までが有効で、登録した時間が来るとexpireする）.有効な日時が終わると,案件はexpireして,ユーザは達成報告をできなくなる.

##ここまでの全てを入力し終えたら,registerボタンを押し,Wallet画面で報酬数分のSOLのロックを求められるので、承認をして、案件登録を完了させる.（Solana Programとの連携が発生）

##登録が完了した案件は,マイページのテーブルに行で表示される.案件が有効な期間であれば,available.有効な期間が終わっていれば。exprireが行の頭に表示されている、複数の案件を登録していれば,すべての案件がテーブルには表示されている.テーブルには登録時間の最新10件が表示され、古いものは2ページ目になる.テーブルには絞り込み機能を実装し,availableな案件だけを表示できる.

##委託者ユーザは案件の削除はできないが、報酬数の更新は可能。もし有効な期間の終了が近づいても、効な期間の終了が近づいて、も、案件を達成してくれる。一般ユーザーが現れない場合は、報酬数を積み上げて、募集を募ることができる。※積み上げはできるが、報酬数を減らすことはできない。（Solana Programとの連携が発生）

##一般ユーザが案件への達成報告をした場合（judgeステータスとなっている状態）,テーブルの該当案件の行にはjudgeのボタンが表示される.judgeボタンをクリックすると,一般ユーザの誰かが案件達成を行った時点で生成されている該当案件のreportページへと遷移する.

##reportページには以下の内容が表示される.

・reportを提出したユーザのユーザ名（＝Walletアドレス）

・提出日時

・reporting movies(ユーザがサーバにアップした動画ファイルを表示)

・動画が撮影された時間帯を表示（year/month/day/hour/minutes/seconds～year/month/day/hour/minutes/seconds）

・ページの最下部には、acceptボタンと、declineボタンがあり、acceptボタンを押するとWalletの署名ボタンが立ち上がり、OKすると、一般ユーザーに対して報酬が送金されます。（Solana Programとの連携が発生）

・declineボタンをクリックすると、一般ユーザへの送金は発生せず、judgeステータスは解除され、該当案件の有効期間終了後に、自動的にロックしていたSOLのロックは解除され、委託者ユーザのWalletに戻る。

#一般ユーザ向けの機能

1. **ログイン・Wallet接続:**
    - 委託者と同様に、Phantom WalletなどのSolana互換ウォレットを使用したWallet Connectによる接続・認証機能。ReownのAppkitを使った、電子メールログインも実装する。
    - ログイン状態を維持し、ユーザー固有の情報（後述のマイページなど）にアクセスできるようにする。
2. **案件一覧・検索機能:**
    - 委託者によって登録され、現在「available」（募集中）な状態の案件を一覧表示するページ。
    - 各案件について、以下の情報が簡潔に表示される:
        - 案件タイトル
        - 国名（Country）,都市名（City）※セットで一項目として表示
        - 「出発地」～「到着地」※セットで一項目として表示
        - 報酬額 (SOL)
        - 有効期限
    - **絞り込み機能:**
        - 国名
    - **ソート機能:**
        - 新着順、報酬額順、有効期限順などで並び替えできる機能。
    - 委託者のマイページと同様に、多数の案件がある場合はページネーションを実装。
3. **案件詳細表示:**
    - 一覧から特定の案件を選択すると、その詳細情報を表示するページへ遷移。
    - 表示される内容:
        - **詳細なルート情報:** Google Maps APIを利用したインタラクティブな地図表示。委託者が設定したルートが明確に表示される。
        - **報酬額 (SOL):** 達成時に受け取れるSOLの額。
        - **有効期限:** 案件達成報告が可能な最終日時。
        - **委託者の情報:** Walletアドレス
        - **案件の詳細説明・注意事項:** 委託者が追加した補足情報など。
        - **「Report」ボタン:** この案件に参加する意思を示すボタンで、ボタンをクリックすると動画の撮影画面が立ち上がる。 (後述の達成報告フェーズに進むため)。※他のユーザがReport中、またはReport後に委託者ユーザがJudgeを完了させていない場合は、Reportボタンがグレーアウトされ、チャレンジできなくなる。
4. Report**機能:**
    - Reportボタンを押すと、カメラが起動し、動画撮影が開始される。
    - 動画の撮影は15秒以内。動画の撮影開始から終了までに移動したルート、撮影時間開始時間～終了時間とともにサーバに記録され、委託者側に案件ステータスが「judge」として通知される。
5. **マイページ (一般ユーザー用):**
    - ログインしている一般ユーザー固有のページ。
    - 以下の情報を管理・確認できる:
        - **Report済み案件リスト:** 達成報告を行い、委託者の判定待ち（Judge）、承認済み（Accepted/Paid）、却下済み（Declined）の案件ステータスを表示。
        - **報酬履歴:** 承認されて受け取った報酬 (SOL) の履歴。
6. **通知機能:**
    - （達成報告が委託者によって承認された、または却下された場合に通知を受け取る機能。

**Solana Programとの連携:**

- 一般ユーザーは、委託者が「accept」ボタンを押し、トランザクションが承認された際に、指定された報酬額のSOLを自身のWalletで受け取ることになります。この受け取りプロセスはSolana Programを通じて自動的に行われます。ユーザー自身が能動的にClaim（請求）する操作は、設計によっては必要ないかもしれません（委託者の承認＝送金トリガー）。